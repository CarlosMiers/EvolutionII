<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="centro_costo_resultados" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="bbbb92bd-902b-4c6e-9b99-70fd8d6740d3">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="37"/>
	<property name="net.sf.jasperreports.print.keep.full.text" value="true"/>
	<property name="net.sf.jasperreports.export.xls.remove.empty.space.between.columns" value="true"/>
	<property name="net.sf.jasperreports.export.xls.remove.empty.space.between.rows" value="true"/>
	<property name="net.sf.jasperreports.export.xls.wrap.text" value="false"/>
	<property name="net.sf.jasperreports.export.xls.detect.cell.type" value="true"/>
	<property name="net.sf.jasperreports.export.xls.white.page.background" value="false"/>
	<property name="net.sf.jasperreports.export.xls.show.gridlines" value="true"/>
	<parameter name="cNombreEmpresa" class="java.lang.String"/>
	<parameter name="ncentro" class="java.lang.String"/>
	<parameter name="nmoneda" class="java.lang.String"/>
	<parameter name="FechaInicio" class="java.util.Date"/>
	<parameter name="FechaFinal" class="java.util.Date"/>
	<queryString>
		<![CDATA[SELECT gastos_compras.formatofactura,gastos_compras.fecha,detalle_centro_costo.descripcion,
SUM(detalle_centro_costo.monto*-1) as monto,detalle_centro_costo.idcentro,
detalle_centro_costo.tipo,centro_costo.nombre AS nombrecentro,
proveedores.nombre AS nombreproveedor,
monedas.nombre AS nombremoneda,gastos_compras.moneda,
gastos_compras.idcta,plan.nombre as nombrecuenta
 FROM gastos_compras
 LEFT JOIN proveedores
 ON proveedores.codigo=gastos_compras.proveedor
 LEFT JOIN monedas
 ON monedas.codigo=gastos_compras.moneda
 LEFT JOIN plan
 ON plan.codigo=gastos_compras.idcta
 INNER JOIN detalle_centro_costo
ON detalle_centro_costo.dreferencia=gastos_compras.creferencia
 LEFT JOIN centro_costo
ON centro_costo.codigo=detalle_centro_costo.idcentro
 WHERE gastos_compras.fecha
 BETWEEN $P{FechaInicio} AND $P{FechaFinal}
 AND gastos_compras.moneda=$P{nmoneda}
 AND IF($P{ncentro}<>0,detalle_centro_costo.idcentro= $P{ncentro},TRUE)
 GROUP BY idcta,idcentro
 UNION
 SELECT cabecera_ventas.formatofactura,cabecera_ventas.fecha,detalle_centro_costo.descripcion,
 detalle_centro_costo.monto,detalle_centro_costo.idcentro,
 detalle_centro_costo.tipo,centro_costo.nombre AS nombrecentro,
 clientes.nombre AS nombreproveedor,
 monedas.nombre AS nombremoneda,cabecera_ventas.moneda,
 rubros.idcta,plan.nombre as nombrecuenta
 FROM cabecera_ventas
 LEFT JOIN clientes
 ON clientes.codigo=cabecera_ventas.cliente
  LEFT JOIN detalle_ventas
  ON detalle_ventas.dreferencia=cabecera_ventas.creferencia
  LEFT JOIN productos
 ON productos.codigo=detalle_ventas.codprod
 LEFT JOIN rubros
 ON rubros.codigo=productos.rubro
 LEFT JOIN plan
 ON plan.codigo=rubros.idcta
LEFT JOIN monedas
ON monedas.codigo=cabecera_ventas.moneda
INNER JOIN detalle_centro_costo
ON detalle_centro_costo.dreferencia=cabecera_ventas.creferencia
LEFT JOIN centro_costo
ON centro_costo.codigo=detalle_centro_costo.idcentro
WHERE cabecera_ventas.fecha
BETWEEN $P{FechaInicio} AND $P{FechaFinal}
AND cabecera_ventas.moneda=$P{nmoneda}
 AND IF( $P{ncentro}<>0,detalle_centro_costo.idcentro= $P{ncentro},TRUE)
GROUP BY idcta,idcentro
 ORDER BY tipo,idcentro]]>
	</queryString>
	<field name="formatofactura" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="fecha" class="java.sql.Date">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="descripcion" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="monto" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="idcentro" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="tipo" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nombrecentro" class="java.lang.String"/>
	<field name="nombreproveedor" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nombremoneda" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="moneda" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="idcta" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nombrecuenta" class="java.lang.String"/>
	<variable name="egresos" class="java.lang.Double" resetType="Group" resetGroup="tipo" calculation="Sum">
		<variableExpression><![CDATA[$F{monto}]]></variableExpression>
	</variable>
	<variable name="monto_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{monto}]]></variableExpression>
	</variable>
	<group name="tipo" isReprintHeaderOnEachPage="true">
		<groupExpression><![CDATA[$F{tipo}]]></groupExpression>
		<groupHeader>
			<band height="35">
				<staticText>
					<reportElement x="18" y="16" width="37" height="12" uuid="a8501de8-35f5-4b28-a4ec-3a84f575e9aa"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Cuenta]]></text>
				</staticText>
				<staticText>
					<reportElement x="403" y="5" width="58" height="24" uuid="8bde66ac-1a2b-487a-996c-70576428097f"/>
					<textElement textAlignment="Center">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Centro de Costo]]></text>
				</staticText>
				<staticText>
					<reportElement x="469" y="17" width="82" height="12" uuid="d7f15012-1a83-4013-9e2a-d985d2bc646a"/>
					<textElement textAlignment="Center">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Importe]]></text>
				</staticText>
				<staticText>
					<reportElement x="70" y="17" width="97" height="12" uuid="f2f7483c-007d-494a-841f-2dbfe9ff6425"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Denominación Cuenta]]></text>
				</staticText>
				<line>
					<reportElement x="3" y="0" width="548" height="1" uuid="94ef5d7b-0e7f-48e3-879f-0ac4fc3c140a"/>
				</line>
				<line>
					<reportElement x="3" y="33" width="548" height="1" uuid="6e626e8e-29bf-4bb1-b99f-b3ab8812e293"/>
				</line>
				<staticText>
					<reportElement x="250" y="16" width="127" height="12" uuid="831ad953-fb21-4604-8d2c-76b8d3258f5e"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Descripción]]></text>
				</staticText>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="21">
				<textField>
					<reportElement x="69" y="6" width="100" height="11" uuid="5fff858d-1528-4e3d-9627-0ec75bb1fdad">
						<printWhenExpression><![CDATA[$F{tipo}.intValue()==1]]></printWhenExpression>
					</reportElement>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["TOTAL EGRESOS"]]></textFieldExpression>
				</textField>
				<line>
					<reportElement x="3" y="-1" width="548" height="1" uuid="1828fd03-3562-4fdd-bb39-b9f2564da7d1"/>
				</line>
				<textField>
					<reportElement x="69" y="6" width="100" height="11" uuid="41c85a25-7fe3-48f9-9ab8-b0294452e0c0">
						<printWhenExpression><![CDATA[$F{tipo}.intValue()==0]]></printWhenExpression>
					</reportElement>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["TOTAL INGRESOS"]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00;(#,##0.00)">
					<reportElement x="469" y="6" width="82" height="11" uuid="fc6d04e8-dd03-4d19-bfd1-9260ce1d0a79"/>
					<textElement textAlignment="Right">
						<font fontName="Arial" size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{egresos}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="3" splitType="Stretch"/>
	</title>
	<pageHeader>
		<band height="87" splitType="Stretch">
			<textField>
				<reportElement x="278" y="15" width="174" height="20" uuid="16f86e87-4c44-4c5d-9cc7-728267ad71e2"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA["Página "+$V{PAGE_NUMBER}+" de "]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="453" y="15" width="40" height="20" uuid="f98c50a8-17c9-4118-b113-b082a49ccd13"/>
				<textElement>
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField pattern="d/M/yyyy">
				<reportElement x="448" y="37" width="45" height="12" uuid="83432059-8bbc-4f47-b6a4-6810f6fa2486"/>
				<textElement>
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="414" y="38" width="31" height="11" uuid="d3e358d0-558e-4648-b33b-3e9913ab4564"/>
				<textElement>
					<font fontName="Arial" size="8" isUnderline="false" isStrikeThrough="false"/>
				</textElement>
				<text><![CDATA[Fecha :]]></text>
			</staticText>
			<staticText>
				<reportElement x="16" y="28" width="201" height="16" uuid="85fb62cf-8311-4922-b76c-485e76393fc5"/>
				<textElement textAlignment="Justified">
					<font size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Resultados por Centros de Costo]]></text>
			</staticText>
			<staticText>
				<reportElement x="15" y="47" width="50" height="12" uuid="a31b6043-1a3a-462f-80dd-11f77c71655e"/>
				<textElement textAlignment="Center">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[DESDE EL:]]></text>
			</staticText>
			<staticText>
				<reportElement x="139" y="46" width="50" height="12" uuid="019e4eae-3d26-4b07-b83d-1eee0d576bdd"/>
				<textElement textAlignment="Center">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[HASTA  EL:]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="66" y="47" width="50" height="12" uuid="d54c8b02-1ec0-41cf-9061-4c69b92b9bb1"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FechaInicio}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="191" y="46" width="41" height="13" uuid="fd2aa2a8-d124-44cc-a612-d518e64728c3"/>
				<textElement textAlignment="Left">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FechaFinal}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="18" y="12" width="279" height="15" uuid="fa815b2c-dd55-454f-b581-35559d1abc0a"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{cNombreEmpresa}]]></textFieldExpression>
			</textField>
			<textField pattern="">
				<reportElement x="18" y="65" width="115" height="10" uuid="8db943df-58d6-4c67-8107-3145d9c14810"/>
				<textElement>
					<font fontName="Arial" size="7" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nombremoneda}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="15" splitType="Stretch">
			<textField pattern="">
				<reportElement x="1" y="2" width="61" height="10" uuid="5e22c2a3-64e5-4d2a-97c7-a8696ad5cae4"/>
				<textElement textAlignment="Right">
					<font fontName="SansSerif" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{formatofactura}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;(#,##0.00)">
				<reportElement x="469" y="2" width="82" height="10" uuid="19141bbe-021a-40d1-9af6-9de8655b4655"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{monto}]]></textFieldExpression>
			</textField>
			<textField pattern="">
				<reportElement x="403" y="2" width="58" height="10" uuid="0065cbd2-b790-4418-8735-18ef1b23655e"/>
				<textElement>
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nombrecentro}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="3" y="2" width="57" height="10" uuid="59316e52-3304-4b49-acd4-22805a755bc3"/>
				<textElement>
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{idcta}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement x="69" y="2" width="163" height="10" uuid="0a02d862-d522-48a7-ae76-b94d20dd685c"/>
				<textElement>
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nombrecuenta}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="241" y="2" width="149" height="10" uuid="42a6ed45-2071-4573-ac06-48c2ab8605c7"/>
				<textElement>
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{descripcion}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band height="2" splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="3" splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="43" splitType="Stretch">
			<staticText>
				<reportElement x="47" y="7" width="86" height="12" uuid="c14845ae-ad07-4c78-8063-11a9fbbfd93f"/>
				<textElement textAlignment="Center">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[TOTAL GENERAL]]></text>
			</staticText>
			<line>
				<reportElement x="3" y="2" width="548" height="1" uuid="b8ab1d10-ac89-41df-acb9-273fbc7c8d5a"/>
			</line>
			<line>
				<reportElement x="3" y="25" width="548" height="1" uuid="fdd5819d-41fe-4bc9-ad61-f4b92e13e4ca"/>
			</line>
			<textField pattern="#,##0.00;(-#,##0.00)">
				<reportElement x="451" y="7" width="100" height="12" uuid="8eda793c-b856-4d85-b8d3-bb61375f0728"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{monto_1}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
