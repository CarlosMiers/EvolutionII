<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="utilidadesxventas" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="6034848f-e095-4fb9-a25c-057dfebd9eaf">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="cNombreEmpresa" class="java.lang.String"/>
	<parameter name="cSucursal" class="java.lang.String"/>
	<parameter name="cMoneda" class="java.lang.String"/>
	<parameter name="cRubro" class="java.lang.String"/>
	<parameter name="FechaInicio" class="java.util.Date"/>
	<parameter name="FechaFinal" class="java.util.Date"/>
	<queryString>
		<![CDATA[SELECT cabecera_ventas.sucursal,
sucursales.nombre AS nombresucursal,
detalle_ventas.codprod,
productos.nombre AS nombreproducto,
productos.rubro,
rubros.nombre AS nombrerubro,
SUM(detalle_ventas.cantidad) AS unidades,
detalle_ventas.prcosto,
detalle_ventas.precio,
SUM(detalle_ventas.cantidad*detalle_ventas.prcosto) AS costomercaderia,
SUM(detalle_ventas.cantidad*detalle_ventas.precio) AS ventasnetas,
SUM((detalle_ventas.cantidad*detalle_ventas.precio)-
(detalle_ventas.cantidad*detalle_ventas.prcosto)) AS utilidades
FROM cabecera_ventas
LEFT JOIN sucursales
ON sucursales.codigo=cabecera_ventas.sucursal
LEFT JOIN detalle_ventas
ON detalle_ventas.dreferencia=cabecera_ventas.creferencia
LEFT JOIN productos
ON productos.codigo=detalle_ventas.codprod
LEFT JOIN rubros
ON rubros.codigo=productos.rubro
WHERE cabecera_ventas.fecha BETWEEN $P{FechaInicio} AND $P{FechaFinal}
AND cabecera_ventas.sucursal=$P{cSucursal}
 AND IF($P{cRubro}<>0,productos.rubro=$P{cRubro},TRUE)
 AND !ISNULL(codprod)
 GROUP BY productos.codigo
 ORDER BY productos.rubro,productos.codigo]]>
	</queryString>
	<field name="sucursal" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nombresucursal" class="java.lang.String"/>
	<field name="codprod" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nombreproducto" class="java.lang.String"/>
	<field name="rubro" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nombrerubro" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="unidades" class="java.math.BigDecimal"/>
	<field name="prcosto" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="precio" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="costomercaderia" class="java.math.BigDecimal"/>
	<field name="ventasnetas" class="java.math.BigDecimal"/>
	<field name="utilidades" class="java.math.BigDecimal"/>
	<variable name="costomercaderia_1" class="java.math.BigDecimal" resetType="Group" resetGroup="rubro" calculation="Sum">
		<variableExpression><![CDATA[$F{costomercaderia}]]></variableExpression>
	</variable>
	<variable name="ventasnetas_1" class="java.math.BigDecimal" resetType="Group" resetGroup="rubro" calculation="Sum">
		<variableExpression><![CDATA[$F{ventasnetas}]]></variableExpression>
	</variable>
	<variable name="utilidades_1" class="java.math.BigDecimal" resetType="Group" resetGroup="rubro" calculation="Sum">
		<variableExpression><![CDATA[$F{utilidades}]]></variableExpression>
	</variable>
	<variable name="costomercaderia_2" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{costomercaderia}]]></variableExpression>
	</variable>
	<variable name="ventasnetas_2" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{ventasnetas}]]></variableExpression>
	</variable>
	<variable name="utilidades_2" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{utilidades}]]></variableExpression>
	</variable>
	<group name="rubro" isReprintHeaderOnEachPage="true">
		<groupExpression><![CDATA[$F{rubro}]]></groupExpression>
		<groupHeader>
			<band height="50">
				<staticText>
					<reportElement x="16" y="26" width="100" height="10" uuid="d2a8ae9f-fa0f-4e8c-9aa1-23fa11179fbf"/>
					<textElement textAlignment="Center">
						<font fontName="Arial" size="7" isBold="true"/>
					</textElement>
					<text><![CDATA[Datos del Producto]]></text>
				</staticText>
				<staticText>
					<reportElement x="292" y="26" width="47" height="19" uuid="d2cccb51-f71b-48b6-a46b-522e0f62fc46"/>
					<textElement textAlignment="Center">
						<font fontName="Arial" size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Ult. Precio Venta]]></text>
				</staticText>
				<staticText>
					<reportElement x="201" y="35" width="35" height="10" uuid="73d7a65d-404d-4599-9b17-c21ce1c1cbf5"/>
					<textElement textAlignment="Right">
						<font fontName="Arial" size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Cantidad]]></text>
				</staticText>
				<line>
					<reportElement x="0" y="19" width="549" height="1" uuid="8cd59194-6329-4177-a99a-4295bba42e86"/>
				</line>
				<staticText>
					<reportElement x="10" y="36" width="40" height="10" uuid="5a3cf90d-7517-4aae-84c8-c79245e227da"/>
					<textElement>
						<font fontName="Arial" size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[CÃ³digo]]></text>
				</staticText>
				<line>
					<reportElement x="0" y="48" width="549" height="1" uuid="5fc73ab2-51b6-4e9d-bd20-826521e9de37"/>
				</line>
				<staticText>
					<reportElement x="358" y="35" width="44" height="10" uuid="c1a2bcbd-e3b8-4a53-a272-0a80f1300a29"/>
					<textElement>
						<font fontName="Arial" size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Costo Total]]></text>
				</staticText>
				<staticText>
					<reportElement x="12" y="4" width="28" height="10" uuid="b24ef488-2a1a-44f7-b9d1-fc17fe6fd231"/>
					<textElement>
						<font fontName="Arial" size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Rubro:]]></text>
				</staticText>
				<textField>
					<reportElement x="42" y="4" width="212" height="11" uuid="ca26ade0-0cca-40dd-9ea2-07b5b3ac00e1"/>
					<textElement>
						<font fontName="Arial" size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{rubro} + "    " + $F{nombrerubro}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="63" y="36" width="89" height="10" uuid="0e0d25bd-894d-436e-82f5-02cec2520cb2"/>
					<textElement textAlignment="Center">
						<font fontName="Arial" size="7" isBold="true"/>
					</textElement>
					<text><![CDATA[Nombre de Producto]]></text>
				</staticText>
				<staticText>
					<reportElement x="408" y="35" width="65" height="10" uuid="28452a8e-1964-4948-ad20-619d97bbbb8d"/>
					<textElement textAlignment="Right">
						<font fontName="Arial" size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Total Ventas]]></text>
				</staticText>
				<staticText>
					<reportElement x="241" y="26" width="44" height="19" uuid="da78e805-fa15-468c-a79d-7d39a5c3e9d2"/>
					<textElement textAlignment="Center">
						<font fontName="Arial" size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Ult. Costo Compra]]></text>
				</staticText>
				<staticText>
					<reportElement x="483" y="36" width="65" height="10" uuid="0202ed13-0a95-4933-9f45-7fe79965d32a"/>
					<textElement textAlignment="Center">
						<font fontName="Arial" size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Utilidad]]></text>
				</staticText>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="15">
				<line>
					<reportElement x="1" y="-1" width="549" height="1" uuid="38e26c93-e5a2-4d7e-94cd-40d19b437bb5"/>
				</line>
				<textField>
					<reportElement x="186" y="2" width="149" height="10" uuid="452a56c8-0bf7-4438-a93c-2a57f2171e14"/>
					<textElement textAlignment="Right">
						<font fontName="Arial" size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["Total Rubro :" + $F{nombrerubro}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00">
					<reportElement x="344" y="3" width="58" height="10" uuid="ffe0fe05-bb87-4931-a46a-0bcd8fb8d11a"/>
					<textElement textAlignment="Right">
						<font fontName="Arial" size="6" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{costomercaderia_1}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00">
					<reportElement x="404" y="3" width="69" height="10" uuid="22c06207-6775-43be-b134-033592141228"/>
					<textElement textAlignment="Right">
						<font fontName="Arial" size="6" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{ventasnetas_1}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00">
					<reportElement x="483" y="3" width="67" height="10" uuid="ae61face-e5a9-4c1d-90cf-5bdbd43dd6b6"/>
					<textElement textAlignment="Right">
						<font fontName="Arial" size="6" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{utilidades_1}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="74" splitType="Stretch">
			<staticText>
				<reportElement x="9" y="21" width="270" height="16" uuid="1c2fec0f-e19d-4a5b-8afd-44fa5760de93"/>
				<textElement textAlignment="Justified">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Utilidades por Ventas]]></text>
			</staticText>
			<textField>
				<reportElement x="9" y="5" width="181" height="15" uuid="00a6fb42-4341-4a40-995c-ba57374b48d7"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{cNombreEmpresa}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="473" y="31" width="31" height="11" uuid="d6936019-1819-4974-b706-2a3ba5fe6abd"/>
				<textElement>
					<font fontName="Arial" size="8" isUnderline="false" isStrikeThrough="false"/>
				</textElement>
				<text><![CDATA[Fecha :]]></text>
			</staticText>
			<textField pattern="d/M/yyyy">
				<reportElement x="505" y="31" width="45" height="12" uuid="5f33e8aa-85bd-4819-9102-ad0777ce134e"/>
				<textElement>
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="516" y="8" width="40" height="20" uuid="7d51b83c-330d-40df-85b5-daa9ebce86ce"/>
				<textElement>
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="379" y="8" width="136" height="20" uuid="8439d3d9-8a7e-450d-8de1-e40f951e6f05"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA["PÃ¡gina "+$V{PAGE_NUMBER}+" de "]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="122" y="40" width="50" height="12" uuid="90bd3b85-e1b4-4dc1-9a3a-6dda1387acc4"/>
				<textElement textAlignment="Center">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[HASTA  EL:]]></text>
			</staticText>
			<staticText>
				<reportElement x="10" y="40" width="50" height="12" uuid="76318d55-0963-4ac9-8b20-4a2427499616"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[DESDE EL:]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="64" y="40" width="50" height="13" uuid="178eb505-0544-4eca-b2f8-055bf9b5e558"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FechaInicio}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="178" y="40" width="41" height="12" uuid="fd2df1dc-36b3-479d-a1f1-c7a8d20f46af"/>
				<textElement textAlignment="Left">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FechaFinal}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="9" y="57" width="193" height="11" uuid="577972d6-8628-48ab-9770-370e2f2512cf"/>
				<textElement>
					<font fontName="Arial" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Sucursal : "+$F{nombresucursal}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="14" splitType="Stretch">
			<textField>
				<reportElement x="63" y="2" width="127" height="10" uuid="6c29d597-45a5-4290-979e-5effc8426872"/>
				<textElement>
					<font fontName="Arial" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nombreproducto}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="202" y="2" width="31" height="10" uuid="a5a628bc-2a7f-4a7b-bbfb-736b51b4b46c"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{unidades}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="292" y="2" width="47" height="10" uuid="235cb472-adbc-4d44-8c58-678bc5844aa3"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{precio}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="341" y="2" width="61" height="10" uuid="ef7e11dd-9842-4b60-90f8-9124ea09b26b"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{costomercaderia}]]></textFieldExpression>
			</textField>
			<textField pattern="###0">
				<reportElement x="3" y="2" width="52" height="10" uuid="dbb80ebb-d75d-4555-92b9-f374ea149dce"/>
				<textElement>
					<font fontName="Arial" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{codprod}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="410" y="2" width="63" height="10" uuid="9c033e49-1f22-4abe-a68a-bcbe7f6f80a4"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ventasnetas}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="241" y="2" width="47" height="10" uuid="e93cc156-33cb-43bf-89dc-afe605f8e8b9"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{prcosto}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="485" y="2" width="63" height="10" uuid="2bf6ff6c-4095-4a15-8543-4b06823fe3e6"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{utilidades}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="27" splitType="Stretch">
			<line>
				<reportElement x="0" y="1" width="549" height="1" uuid="360c4566-cad3-4f3e-a09a-46ede823e454"/>
			</line>
			<staticText>
				<reportElement x="241" y="4" width="93" height="12" uuid="c76b9e1f-5d33-43e7-a2e1-03c4db5c0bea"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[Total General]]></text>
			</staticText>
			<line>
				<reportElement x="0" y="19" width="549" height="1" uuid="75418185-b6d8-4582-a0cf-04d0b1eb8e89"/>
			</line>
			<textField pattern="#,##0.00">
				<reportElement x="344" y="6" width="58" height="10" uuid="dd2ea36d-2fd9-490b-a7e8-1a7c428a7c87"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="6" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{costomercaderia_2}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="405" y="6" width="68" height="10" uuid="78094df9-95f2-4017-8217-634bde896fe2"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="6" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{ventasnetas_2}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="477" y="5" width="73" height="11" uuid="17b63199-e258-45cc-a0ca-2f8ff0ccd814"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{utilidades_2}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
