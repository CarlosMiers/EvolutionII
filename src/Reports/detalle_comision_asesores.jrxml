<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="detalle_comision_asesores" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="6034848f-e095-4fb9-a25c-057dfebd9eaf">
	<property name="ireport.zoom" value="2.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="cNombreEmpresa" class="java.lang.String"/>
	<parameter name="nAsesor" class="java.lang.Integer"/>
	<parameter name="cMoneda" class="java.lang.String"/>
	<parameter name="FechaInicio" class="java.util.Date"/>
	<parameter name="FechaFinal" class="java.util.Date"/>
	<queryString>
		<![CDATA[SELECT comisiones.numerobolsa,precierre_operacion.numerobolsa AS numerooperacion,
vendedores.nombre AS nombreasesor,
comisiones.fecha,precierre_operacion.comprador AS cliente,
clientes.nombre AS nombrecliente, 'COMPRA' AS movimiento,
emisores.nombre AS nombreemisor,titulos.nomalias,
titulos.nombre AS nombretitulo,
IF(precierre_operacion.mercado=1,'PRIMARIO','SECUNDARIO') AS tipomercado,
monedas.nombre AS nombremoneda,precierre_operacion.valor_nominal,
precierre_operacion.comcomprador AS porcentajecomisioncobrada,
comisiones.totales AS comisionasesor
FROM comisiones
LEFT JOIN precierre_operacion
ON precierre_operacion.numero=comisiones.numerobolsa
LEFT JOIN clientes
ON clientes.codigo=precierre_operacion.comprador
LEFT JOIN emisores
ON emisores.codigo=precierre_operacion.emisor
LEFT JOIN monedas
ON monedas.codigo=precierre_operacion.moneda
LEFT JOIN titulos
ON titulos.codigo=precierre_operacion.titulo
LEFT JOIN vendedores
ON vendedores.codigo=precierre_operacion.asesorcompra
WHERE precierre_operacion.asesorcompra=$P{nAsesor}
AND comisiones.fecha BETWEEN $P{FechaInicio}
AND $P{FechaFinal}
AND precierre_operacion.moneda=$P{cMoneda}
UNION
SELECT comisiones.numerobolsa,precierre_operacion.numerobolsa AS numerooperacion,comisiones.fecha,
vendedores.nombre AS nombreasesor,
precierre_operacion.vendedor AS cliente,
clientes.nombre AS nombrecliente, 'VENTA' AS movimiento,
emisores.nombre AS nombreemisor,titulos.nomalias,
titulos.nombre AS nombretitulo,
IF(precierre_operacion.mercado=1,'PRIMARIO','SECUNDARIO') AS tipomercado,
monedas.nombre AS nombremoneda,precierre_operacion.valor_nominal,
precierre_operacion.comvendedor AS porcentajecomisioncobrada,
comisiones.totales AS comisionasesor
FROM comisiones
LEFT JOIN precierre_operacion
ON precierre_operacion.numero=comisiones.numerobolsa
LEFT JOIN clientes
ON clientes.codigo=precierre_operacion.vendedor
LEFT JOIN emisores
ON emisores.codigo=precierre_operacion.emisor
LEFT JOIN monedas
ON monedas.codigo=precierre_operacion.moneda
LEFT JOIN titulos
ON titulos.codigo=precierre_operacion.titulo
LEFT JOIN vendedores
ON vendedores.codigo=precierre_operacion.asesorventa
WHERE precierre_operacion.asesorventa=$P{nAsesor}
AND comisiones.fecha BETWEEN $P{FechaInicio}
AND $P{FechaFinal}
AND precierre_operacion.moneda=$P{cMoneda}
ORDER BY fecha]]>
	</queryString>
	<field name="numerobolsa" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="numerooperacion" class="java.lang.String"/>
	<field name="nombreasesor" class="java.lang.String"/>
	<field name="fecha" class="java.util.Date">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="cliente" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nombrecliente" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="movimiento" class="java.lang.String"/>
	<field name="nombreemisor" class="java.lang.String"/>
	<field name="nomalias" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nombretitulo" class="java.lang.String"/>
	<field name="tipomercado" class="java.lang.String"/>
	<field name="nombremoneda" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="valor_nominal" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="porcentajecomisioncobrada" class="java.math.BigDecimal"/>
	<field name="comisionasesor" class="java.math.BigDecimal"/>
	<variable name="comisionasesor_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{comisionasesor}]]></variableExpression>
	</variable>
	<variable name="valor_nominal_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{valor_nominal}]]></variableExpression>
	</variable>
	<variable name="porcentajecomisioncobrada_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{porcentajecomisioncobrada}]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="158">
			<image>
				<reportElement x="3" y="3" width="151" height="77" uuid="d31e1e05-fbbf-4f2b-8e06-620847e90591"/>
				<imageExpression><![CDATA["C:\\Sistemas\\EvolutionII\\EvolutionII\\src\\Images\\LogoFais.jpg"]]></imageExpression>
			</image>
			<staticText>
				<reportElement x="203" y="24" width="320" height="14" uuid="1c2fec0f-e19d-4a5b-8afd-44fa5760de93"/>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Detalle de Comisiones Asesores]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="626" y="74" width="63" height="12" uuid="a59f5a64-bb09-40aa-a7db-ae7e4f56eae5"/>
				<textElement>
					<font fontName="Arial" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FechaInicio}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="626" y="89" width="59" height="12" uuid="5f33e8aa-85bd-4819-9102-ad0777ce134e"/>
				<textElement>
					<font fontName="Arial" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="209" y="62" width="253" height="12" uuid="021a14d3-6ec5-47c8-902b-1de0044f960c"/>
				<textElement>
					<font fontName="Arial" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Nombre: "+$F{nombreasesor}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="209" y="80" width="334" height="12" uuid="503dca1b-4e33-4cf2-90fd-51469c0003ef"/>
				<textElement>
					<font fontName="Arial" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Moneda: "+$F{nombremoneda}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="560" y="74" width="47" height="12" uuid="b6bd845f-4feb-4d78-b548-1a5449a71875"/>
				<textElement>
					<font fontName="Arial" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Desde el:"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="560" y="89" width="57" height="12" uuid="bb792d45-a610-46a3-bd3f-0e37241b137c"/>
				<textElement>
					<font fontName="Arial" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Fecha Actual: "]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="560" y="105" width="150" height="15" uuid="b2b0fe7b-314d-4a47-8b74-542b958f838f"/>
				<textElement>
					<font fontName="Arial" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Página "+$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="241" y="139" width="34" height="10" uuid="8ae59c5b-8318-481f-b795-5de02d5521f4"/>
				<textElement>
					<font fontName="Arial" size="8"/>
				</textElement>
				<text><![CDATA[Emisor]]></text>
			</staticText>
			<staticText>
				<reportElement x="372" y="139" width="49" height="10" uuid="48cda162-fc32-4c47-a48e-499facd40d64"/>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="8"/>
				</textElement>
				<text><![CDATA[Serie]]></text>
			</staticText>
			<staticText>
				<reportElement x="589" y="134" width="44" height="21" uuid="8b8cb6d4-e156-4f5f-b471-bb29bc59b091"/>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="8"/>
				</textElement>
				<text><![CDATA[Valor Nominal]]></text>
			</staticText>
			<staticText>
				<reportElement x="449" y="139" width="63" height="10" uuid="8669b6c5-75a4-442e-a133-7595d95353a0"/>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="8"/>
				</textElement>
				<text><![CDATA[Título]]></text>
			</staticText>
			<staticText>
				<reportElement x="5" y="139" width="43" height="10" uuid="3a676fdb-d85f-4d41-b03d-1f097bae3b93"/>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="8"/>
				</textElement>
				<text><![CDATA[Fecha]]></text>
			</staticText>
			<staticText>
				<reportElement x="752" y="134" width="41" height="21" uuid="d905b9a9-15ee-4d46-8001-ec6b1cb6659a"/>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="8"/>
				</textElement>
				<text><![CDATA[Comisión Asesor]]></text>
			</staticText>
			<line>
				<reportElement x="0" y="155" width="802" height="1" uuid="ad86a427-8304-4a66-b3af-71ec89215280"/>
			</line>
			<line>
				<reportElement x="0" y="130" width="802" height="1" uuid="822f325d-2285-46c2-9e78-5b3415631389"/>
			</line>
			<staticText>
				<reportElement x="116" y="139" width="106" height="10" uuid="43a9f49b-66cb-4570-8901-e69321458223"/>
				<textElement>
					<font fontName="Arial" size="8"/>
				</textElement>
				<text><![CDATA[Nombre Cliente]]></text>
			</staticText>
			<staticText>
				<reportElement x="519" y="139" width="42" height="10" uuid="60c3f8da-5882-4fcd-a229-ef126c39e47b"/>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="8"/>
				</textElement>
				<text><![CDATA[Mercado]]></text>
			</staticText>
			<staticText>
				<reportElement x="646" y="134" width="44" height="21" uuid="c8191291-45bd-4765-8a14-f584059568e5"/>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="8"/>
				</textElement>
				<text><![CDATA[% Comisión Cobrada]]></text>
			</staticText>
			<staticText>
				<reportElement x="700" y="134" width="44" height="21" uuid="a47965d1-b867-4f13-a67d-ded31c1f4914"/>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="8"/>
				</textElement>
				<text><![CDATA[Comisión Cobrada]]></text>
			</staticText>
			<staticText>
				<reportElement x="53" y="139" width="50" height="10" uuid="42fd42d5-4774-4ab8-8970-cefe09cb8feb"/>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="8"/>
				</textElement>
				<text><![CDATA[N° Operación]]></text>
			</staticText>
		</band>
	</pageHeader>
	<detail>
		<band height="14" splitType="Stretch">
			<textField isStretchWithOverflow="true" pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="240" y="2" width="118" height="10" uuid="6e4afdb5-6273-4766-9b53-6e7129470f8c"/>
				<textElement>
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nombreemisor}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,##0">
				<reportElement x="365" y="2" width="73" height="10" uuid="46cb153b-8f75-4f0f-94cc-d5875aef0b34"/>
				<textElement>
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nomalias}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="573" y="2" width="70" height="10" uuid="0ddb4022-6272-4568-9b75-9521929dfad2"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{valor_nominal}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="448" y="2" width="64" height="10" uuid="1538a4bb-19ae-4eab-a468-508c60c84a47"/>
				<textElement>
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nombretitulo}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="754" y="2" width="45" height="10" uuid="a39575be-e58f-4a50-840e-1cce6004e8e4"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{comisionasesor}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="115" y="2" width="118" height="10" uuid="19feabd0-3d20-4fae-8f3a-3014788fb2a3"/>
				<textElement>
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nombrecliente}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="2" y="2" width="46" height="10" uuid="e0a09963-d4a8-4946-be49-05c01a5f8ed1"/>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{fecha}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="519" y="2" width="46" height="10" uuid="a6e7e076-99a4-4bd3-a6ff-447b31174ae0"/>
				<textElement>
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{tipomercado}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="652" y="2" width="30" height="10" uuid="af9810cd-9746-4cd0-ba58-a938d3200ceb"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{porcentajecomisioncobrada}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="700" y="2" width="45" height="10" uuid="8d33d641-62e8-4498-a5a7-428acc91fa10"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[new Double($F{valor_nominal}.doubleValue()*$F{porcentajecomisioncobrada}.doubleValue())/100]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,##0">
				<reportElement x="53" y="2" width="50" height="10" uuid="885a5fb7-5bf9-43c9-8af5-86f235004658"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{numerooperacion}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="62">
			<line>
				<reportElement x="0" y="2" width="802" height="1" uuid="7a2606e8-1e9b-47ee-a97e-31e250eec48b"/>
			</line>
			<line>
				<reportElement x="0" y="18" width="802" height="1" uuid="5b134080-1d3a-4fcf-9007-3cd5488bbd68"/>
			</line>
			<textField pattern="#,##0.00">
				<reportElement x="754" y="6" width="45" height="10" uuid="051232a9-8354-450b-b893-6c8983ed0fc4"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{comisionasesor_1}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
