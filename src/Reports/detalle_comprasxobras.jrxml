<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="detalle_comprasxobras" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="6034848f-e095-4fb9-a25c-057dfebd9eaf">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="cNombreEmpresa" class="java.lang.String"/>
	<parameter name="FechaInicio" class="java.util.Date"/>
	<parameter name="FechaFinal" class="java.util.Date"/>
	<parameter name="cObra" class="java.lang.String"/>
	<parameter name="cMoneda" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT obras.nombre AS nombreobra,cabecera_compras.formatofactura,cabecera_compras.nrofactura,cabecera_compras.obra,
cabecera_compras.totalneto,
cabecera_compras.proveedor,proveedores.nombre AS nombreproveedor,
cabecera_compras.fecha,cabecera_compras.moneda,monedas.nombre AS nombremoneda,
sucursales.nombre AS nombresucursal,
comprobantes.nombre AS nombrecomprobante
FROM cabecera_compras
LEFT JOIN proveedores
ON proveedores.codigo=cabecera_compras.proveedor
LEFT JOIN monedas
ON monedas.codigo=cabecera_compras.moneda
LEFT JOIN sucursales
ON sucursales.codigo=cabecera_compras.sucursal
LEFT JOIN comprobantes
ON comprobantes.codigo=cabecera_compras.comprobante
INNER JOIN obras
ON obras.codigo=cabecera_compras.obra
 WHERE cabecera_compras.fecha BETWEEN $P{FechaInicio} AND $P{FechaFinal}
 AND IF($P{cObra}<>0,cabecera_compras.obra=$P{cObra},TRUE)
 AND cabecera_compras.moneda=$P{cMoneda}
AND cabecera_compras.obra>0
ORDER BY cabecera_compras.obra,cabecera_compras.fecha]]>
	</queryString>
	<field name="nombreobra" class="java.lang.String"/>
	<field name="formatofactura" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nrofactura" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="obra" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="totalneto" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="proveedor" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nombreproveedor" class="java.lang.String"/>
	<field name="fecha" class="java.sql.Date">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="moneda" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nombremoneda" class="java.lang.String"/>
	<field name="nombresucursal" class="java.lang.String"/>
	<field name="nombrecomprobante" class="java.lang.String"/>
	<variable name="total_5" class="java.lang.Double" resetType="Group" resetGroup="obra" calculation="Sum">
		<variableExpression><![CDATA[$F{totalneto}]]></variableExpression>
	</variable>
	<variable name="total_6" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{totalneto}]]></variableExpression>
	</variable>
	<group name="obra" isReprintHeaderOnEachPage="true">
		<groupExpression><![CDATA[$F{obra}]]></groupExpression>
		<groupHeader>
			<band height="40">
				<staticText>
					<reportElement x="4" y="4" width="45" height="10" uuid="b24ef488-2a1a-44f7-b9d1-fc17fe6fd231"/>
					<textElement>
						<font fontName="Arial" size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Obra:]]></text>
				</staticText>
				<textField>
					<reportElement x="49" y="4" width="212" height="11" uuid="ca26ade0-0cca-40dd-9ea2-07b5b3ac00e1"/>
					<textElement>
						<font fontName="Arial" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{nombreobra}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="11" y="23" width="40" height="10" uuid="5a3cf90d-7517-4aae-84c8-c79245e227da"/>
					<textElement>
						<font fontName="Arial" size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Factura]]></text>
				</staticText>
				<staticText>
					<reportElement x="494" y="21" width="44" height="10" uuid="c1a2bcbd-e3b8-4a53-a272-0a80f1300a29"/>
					<textElement>
						<font fontName="Arial" size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Total Factura]]></text>
				</staticText>
				<line>
					<reportElement x="0" y="19" width="549" height="1" uuid="5fc73ab2-51b6-4e9d-bd20-826521e9de37"/>
				</line>
				<staticText>
					<reportElement x="71" y="23" width="40" height="10" uuid="5c9663c3-702b-4019-afd9-35ca25e19135"/>
					<textElement textAlignment="Center">
						<font fontName="Arial" size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Fecha]]></text>
				</staticText>
				<staticText>
					<reportElement x="329" y="25" width="89" height="10" uuid="0e0d25bd-894d-436e-82f5-02cec2520cb2"/>
					<textElement>
						<font fontName="Arial" size="7" isBold="true"/>
					</textElement>
					<text><![CDATA[Nombre del Proveedor]]></text>
				</staticText>
				<staticText>
					<reportElement x="217" y="25" width="78" height="10" uuid="cadd0d71-ca19-4c75-814a-63a7ec34e924"/>
					<textElement>
						<font fontName="Arial" size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Sucursal]]></text>
				</staticText>
				<line>
					<reportElement x="0" y="35" width="549" height="1" uuid="8cd59194-6329-4177-a99a-4295bba42e86"/>
				</line>
				<staticText>
					<reportElement x="123" y="23" width="56" height="10" uuid="4d89b7f0-f101-408e-a820-5a36acf7bdc1"/>
					<textElement textAlignment="Center">
						<font fontName="Arial" size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Comprobante]]></text>
				</staticText>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="23">
				<line>
					<reportElement x="1" y="-1" width="549" height="1" uuid="38e26c93-e5a2-4d7e-94cd-40d19b437bb5"/>
				</line>
				<textField evaluationTime="Group" evaluationGroup="obra" pattern="#,##0.00">
					<reportElement x="458" y="3" width="86" height="12" uuid="4ba73d0d-5eeb-4011-b8ad-d48911db90ce"/>
					<textElement textAlignment="Right">
						<font fontName="Arial" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{total_5}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="96" y="3" width="245" height="11" uuid="89e32ee0-5d34-4e3a-8aba-4f70e8894fd1"/>
					<textElement textAlignment="Right">
						<font fontName="Arial" size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["Total Obra  " + $F{nombreobra}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="74" splitType="Stretch">
			<staticText>
				<reportElement x="9" y="21" width="208" height="16" uuid="1c2fec0f-e19d-4a5b-8afd-44fa5760de93"/>
				<textElement textAlignment="Justified">
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Detalle de Compras por Obras]]></text>
			</staticText>
			<textField>
				<reportElement x="9" y="5" width="181" height="15" uuid="00a6fb42-4341-4a40-995c-ba57374b48d7"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{cNombreEmpresa}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="477" y="31" width="31" height="11" uuid="d6936019-1819-4974-b706-2a3ba5fe6abd"/>
				<textElement>
					<font fontName="Arial" size="8" isUnderline="false" isStrikeThrough="false"/>
				</textElement>
				<text><![CDATA[Fecha :]]></text>
			</staticText>
			<textField pattern="d/M/yyyy">
				<reportElement x="509" y="31" width="45" height="12" uuid="5f33e8aa-85bd-4819-9102-ad0777ce134e"/>
				<textElement>
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="516" y="8" width="40" height="20" uuid="7d51b83c-330d-40df-85b5-daa9ebce86ce"/>
				<textElement>
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="341" y="8" width="174" height="20" uuid="8439d3d9-8a7e-450d-8de1-e40f951e6f05"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA["PÃ¡gina "+$V{PAGE_NUMBER}+" de "]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="123" y="40" width="50" height="12" uuid="90bd3b85-e1b4-4dc1-9a3a-6dda1387acc4"/>
				<textElement textAlignment="Center">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[HASTA  EL:]]></text>
			</staticText>
			<staticText>
				<reportElement x="11" y="40" width="50" height="12" uuid="76318d55-0963-4ac9-8b20-4a2427499616"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[DESDE EL:]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="65" y="40" width="50" height="13" uuid="178eb505-0544-4eca-b2f8-055bf9b5e558"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FechaInicio}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="179" y="40" width="41" height="12" uuid="fd2df1dc-36b3-479d-a1f1-c7a8d20f46af"/>
				<textElement textAlignment="Left">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FechaFinal}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="9" y="59" width="40" height="10" uuid="e103b176-cab2-4983-a7e1-b4e258f71b34"/>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Moneda]]></text>
			</staticText>
			<textField>
				<reportElement x="71" y="59" width="176" height="10" uuid="e8613235-4d60-48e4-a241-e52b920bda02"/>
				<textElement>
					<font fontName="Arial" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nombremoneda}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="14" splitType="Stretch">
			<textField pattern="dd/MM/yyyy">
				<reportElement x="68" y="3" width="47" height="10" uuid="42324b06-3d6d-4c98-ab18-0786b039ef1e"/>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{fecha}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="120" y="3" width="77" height="10" uuid="3c7dc5fb-d222-4c78-aba8-c437f5886480"/>
				<textElement>
					<font fontName="Arial" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nombrecomprobante}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="329" y="3" width="125" height="10" uuid="6c29d597-45a5-4290-979e-5effc8426872"/>
				<textElement>
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nombreproveedor}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="458" y="3" width="86" height="10" uuid="ef7e11dd-9842-4b60-90f8-9124ea09b26b"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{totalneto}]]></textFieldExpression>
			</textField>
			<textField pattern="###0">
				<reportElement x="3" y="4" width="59" height="10" uuid="dbb80ebb-d75d-4555-92b9-f374ea149dce"/>
				<textElement>
					<font fontName="Arial" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{formatofactura}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="206" y="3" width="102" height="10" uuid="2b112c89-afa2-4fdb-a820-cf1f901efd18"/>
				<textElement>
					<font fontName="Arial" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nombresucursal}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="27" splitType="Stretch">
			<line>
				<reportElement x="0" y="1" width="549" height="1" uuid="360c4566-cad3-4f3e-a09a-46ede823e454"/>
			</line>
			<staticText>
				<reportElement x="274" y="8" width="77" height="15" uuid="c76b9e1f-5d33-43e7-a2e1-03c4db5c0bea"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[Total General]]></text>
			</staticText>
			<line>
				<reportElement x="0" y="26" width="549" height="1" uuid="75418185-b6d8-4582-a0cf-04d0b1eb8e89"/>
			</line>
			<textField pattern="#,##0.00">
				<reportElement x="456" y="7" width="88" height="12" uuid="41273154-6f43-489d-8626-820162ad0b71"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{total_6}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
